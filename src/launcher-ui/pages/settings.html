<div class="grid">
    <span id="data" class="container card">
        <span class="title">Settings</span>
        <span class="content">
            <p>
                <span class="two-grid">
                    <span>Update channel</span>
                    <span>
                        <span class="input">
                            <input type="radio" id="channel-main" name="channel" value="channel-main">
                            <label for="channel-main">Stable</label>
                        </span>
                        <span class="input">
                            <input type="radio" id="channel-dev" name="channel" value="channel-dev">
                            <label for="channel-dev">Experimental</label>
                        </span>
                    </span>
                </span>
            </p>
        </span>
    </span>
</div>

<style>
    #content>.grid {
        display: flex;
        width: 100%;
    }

    #data {
        flex: 1 1 auto;
    }
</style>

<script>
    function handleChannelChange() {
        const id = this.id;
        const newChannel = id.substring(8);
        console.log(newChannel);

        window.channel.then(channel => {
            if (channel == newChannel) {
                return;
            }

            const channelNames = {
                'main': 'stable',
                'dev': 'experimental',
            };

            const channelName = channelNames[newChannel];

            window.showMessageBox("Warning",
                `You are about to switch to the ${channelName} channel. Are you sure you want to do that?`,
                ["Yes", "Cancel"]).then(index => {
                if (index == 0) {
                    executeCommand('switch-channel', {
                        'channel': newChannel
                    });
                } else {
                    checkCurrentChannelRadio();
                }
            });
        });
    }

    function checkCurrentChannelRadio() {
        window.channel.then(channel => {
            document.querySelector(`input#channel-${channel}`).checked = true;
        });
    }

    checkCurrentChannelRadio();

    var nodes = document.querySelectorAll('input[name="channel"]');
    for (var i = 0; i < nodes.length; ++i) {
        nodes[i].onclick = handleChannelChange;
    }
</script>